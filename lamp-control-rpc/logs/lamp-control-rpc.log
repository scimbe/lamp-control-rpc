2025-04-15 12:03:38.285 [main] INFO  c.r.l.m.registry.RegistryServer - Starting registry server on port 7777
2025-04-15 12:03:38.291 [main] INFO  c.r.l.m.transport.ServerTransport - Server started on port 7777
2025-04-15 12:03:38.292 [main] INFO  c.r.l.m.registry.RegistryServer - Registry server started on port 7777
2025-04-15 12:03:38.292 [main] INFO  c.r.l.m.registry.RegistryLauncher - Registry server running on port 7777. Press Ctrl+C to exit.
2025-04-15 12:03:52.750 [main] INFO  c.r.l.middleware.rpc.RpcServer - Starting RPC server on port 0
2025-04-15 12:03:52.756 [main] INFO  c.r.l.m.transport.ServerTransport - Server started on port 51123
2025-04-15 12:03:52.757 [main] INFO  c.r.l.middleware.rpc.RpcServer - RPC server started on port 51123
2025-04-15 12:03:52.757 [main] INFO  c.r.l.application.server.LampImpl - Lamp 'Main Lamp' created, initial state: OFF
2025-04-15 12:03:52.758 [main] INFO  c.r.l.middleware.rpc.RpcServer - Registered function 'toggle' locally
2025-04-15 12:03:52.758 [main] INFO  c.r.l.m.registry.RegistryClient - Registering service 'toggle' at localhost:51123 with registry
2025-04-15 12:03:52.772 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:7777 (timeout: 5000 ms)
2025-04-15 12:03:52.777 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:7777
2025-04-15 12:03:52.777 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:51124
2025-04-15 12:03:52.779 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:51124
2025-04-15 12:03:52.844 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"register","traceId":"806c3839-8ceb-40c6-a4d3-f0ff71149f2f","functionName":"toggle","host":"localhost","port":51123}
2025-04-15 12:03:52.845 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"register","traceId":"806c3839-8ceb-40c6-a4d3-f0ff71149f2f","functionName":"toggle","host":"localhost","port":51123}
2025-04-15 12:03:52.915 [pool-1-thread-2] ERROR c.r.l.m.common.JsonSerializer - Failed to deserialize message: Cannot construct instance of `com.rpc.lampcontrol.middleware.protocol.Message` (no Creators, like default constructor, exist): abstract types either need to be mapped to concrete types, have custom deserializer, or contain additional type information
 at [Source: (String)"{"version":"1.0","type":"register","traceId":"806c3839-8ceb-40c6-a4d3-f0ff71149f2f","functionName":"toggle","host":"localhost","port":51123}"; line: 1, column: 1]
2025-04-15 12:03:52.915 [pool-1-thread-2] ERROR c.r.l.m.registry.RegistryServer - Error handling connection: Failed to deserialize received message
2025-04-15 12:03:52.916 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:51124
2025-04-15 12:03:52.917 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:7777
2025-04-15 12:03:52.917 [main] ERROR c.r.l.m.registry.RegistryClient - Error registering service: Received null message, connection may be closed
2025-04-15 12:03:52.917 [main] ERROR c.r.l.application.server.ServerMain - Error registering lamp functions: Failed to register service: Received null message, connection may be closed
2025-04-15 12:07:38.512 [main] INFO  c.r.l.m.registry.RegistryServer - Starting registry server on port 7777
2025-04-15 12:07:38.519 [main] ERROR c.r.l.m.registry.RegistryLauncher - Failed to start registry server: Address already in use
2025-04-15 12:07:38.520 [Thread-0] INFO  c.r.l.m.registry.RegistryLauncher - Shutting down registry server...
2025-04-15 12:07:38.521 [Thread-0] INFO  c.r.l.m.registry.RegistryServer - Stopping registry server
2025-04-15 12:07:38.521 [Thread-0] INFO  c.r.l.m.registry.RegistryServer - Registry server stopped
2025-04-15 12:07:46.351 [main] INFO  c.r.l.middleware.rpc.RpcServer - Starting RPC server on port 0
2025-04-15 12:07:46.358 [main] INFO  c.r.l.m.transport.ServerTransport - Server started on port 53394
2025-04-15 12:07:46.359 [main] INFO  c.r.l.middleware.rpc.RpcServer - RPC server started on port 53394
2025-04-15 12:07:46.359 [main] INFO  c.r.l.application.server.LampImpl - Lamp 'Main Lamp' created, initial state: OFF
2025-04-15 12:07:46.359 [main] INFO  c.r.l.middleware.rpc.RpcServer - Registered function 'toggle' locally
2025-04-15 12:07:46.359 [main] INFO  c.r.l.m.registry.RegistryClient - Registering service 'toggle' at localhost:53394 with registry
2025-04-15 12:07:46.372 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:7777 (timeout: 5000 ms)
2025-04-15 12:07:46.376 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:7777
2025-04-15 12:07:46.376 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:53397
2025-04-15 12:07:46.379 [pool-1-thread-3] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:53397
2025-04-15 12:07:46.453 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"register","traceId":"eb1d6138-45be-4af2-b5e9-d587ceea2f1f","functionName":"toggle","host":"localhost","port":53394}
2025-04-15 12:07:46.454 [pool-1-thread-3] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"register","traceId":"eb1d6138-45be-4af2-b5e9-d587ceea2f1f","functionName":"toggle","host":"localhost","port":53394}
2025-04-15 12:07:46.455 [pool-1-thread-3] ERROR c.r.l.m.common.JsonSerializer - Failed to deserialize message: Cannot construct instance of `com.rpc.lampcontrol.middleware.protocol.Message` (no Creators, like default constructor, exist): abstract types either need to be mapped to concrete types, have custom deserializer, or contain additional type information
 at [Source: (String)"{"version":"1.0","type":"register","traceId":"eb1d6138-45be-4af2-b5e9-d587ceea2f1f","functionName":"toggle","host":"localhost","port":53394}"; line: 1, column: 1]
2025-04-15 12:07:46.455 [pool-1-thread-3] ERROR c.r.l.m.registry.RegistryServer - Error handling connection: Failed to deserialize received message
2025-04-15 12:07:46.455 [pool-1-thread-3] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:53397
2025-04-15 12:07:46.456 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:7777
2025-04-15 12:07:46.456 [main] ERROR c.r.l.m.registry.RegistryClient - Error registering service: Received null message, connection may be closed
2025-04-15 12:07:46.456 [main] ERROR c.r.l.application.server.ServerMain - Error registering lamp functions: Failed to register service: Received null message, connection may be closed
2025-04-15 12:08:19.811 [Thread-0] INFO  c.r.l.m.registry.RegistryLauncher - Shutting down registry server...
2025-04-15 12:08:19.813 [Thread-0] INFO  c.r.l.m.registry.RegistryServer - Stopping registry server
2025-04-15 12:08:19.814 [Thread-0] INFO  c.r.l.m.transport.ServerTransport - Server stopped
2025-04-15 12:08:19.815 [Thread-0] INFO  c.r.l.m.registry.RegistryServer - Registry server stopped
2025-04-15 12:08:38.743 [main] INFO  c.r.l.m.registry.RegistryServer - Starting registry server on port 8888
2025-04-15 12:08:38.749 [main] INFO  c.r.l.m.transport.ServerTransport - Server started on port 8888
2025-04-15 12:08:38.750 [main] INFO  c.r.l.m.registry.RegistryServer - Registry server started on port 8888
2025-04-15 12:08:38.750 [main] INFO  c.r.l.m.registry.RegistryLauncher - Registry server running on port 8888. Press Ctrl+C to exit.
2025-04-15 12:12:08.840 [main] INFO  c.r.l.m.registry.RegistryServer - Starting registry server on port 8888
2025-04-15 12:12:08.848 [main] ERROR c.r.l.m.registry.RegistryLauncher - Failed to start registry server: Address already in use
2025-04-15 12:12:08.849 [Thread-0] INFO  c.r.l.m.registry.RegistryLauncher - Shutting down registry server...
2025-04-15 12:12:08.849 [Thread-0] INFO  c.r.l.m.registry.RegistryServer - Stopping registry server
2025-04-15 12:12:08.850 [Thread-0] INFO  c.r.l.m.registry.RegistryServer - Registry server stopped
2025-04-15 12:12:21.364 [main] INFO  c.r.l.application.server.ServerMain - Using registry port: 8888
2025-04-15 12:12:21.365 [main] INFO  c.r.l.m.registry.RegistryClient - RegistryClient configured to use registry at localhost:8888
2025-04-15 12:12:21.367 [main] INFO  c.r.l.middleware.rpc.RpcServer - Starting RPC server on port 0
2025-04-15 12:12:21.373 [main] INFO  c.r.l.m.transport.ServerTransport - Server started on port 55971
2025-04-15 12:12:21.373 [main] INFO  c.r.l.middleware.rpc.RpcServer - RPC server started on port 55971
2025-04-15 12:12:21.374 [main] INFO  c.r.l.application.server.LampImpl - Lamp 'Main Lamp' created, initial state: OFF
2025-04-15 12:12:21.374 [main] INFO  c.r.l.middleware.rpc.RpcServer - Registered function 'toggle' locally
2025-04-15 12:12:21.374 [main] INFO  c.r.l.m.registry.RegistryClient - Registering service 'toggle' at localhost:55971 with registry at localhost:8888
2025-04-15 12:12:21.390 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:8888 (timeout: 5000 ms)
2025-04-15 12:12:21.395 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:8888
2025-04-15 12:12:21.397 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:55972
2025-04-15 12:12:21.402 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:55972
2025-04-15 12:12:21.472 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"register","traceId":"7cd91eac-6d02-4583-ae28-1ab4139427bd","functionName":"toggle","host":"localhost","port":55971}
2025-04-15 12:12:21.473 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Received raw message: {"version":"1.0","type":"register","traceId":"7cd91eac-6d02-4583-ae28-1ab4139427bd","functionName":"toggle","host":"localhost","port":55971}
2025-04-15 12:12:21.582 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Received register request for function 'toggle' at localhost:55971
2025-04-15 12:12:21.582 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Function 'toggle' registered successfully at localhost:55971
2025-04-15 12:12:21.591 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"registerResponse","traceId":"7cd91eac-6d02-4583-ae28-1ab4139427bd","status":"success","message":"Function 'toggle' registered successfully","success":true}
2025-04-15 12:12:21.592 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"registerResponse","traceId":"7cd91eac-6d02-4583-ae28-1ab4139427bd","status":"success","message":"Function 'toggle' registered successfully","success":true}
2025-04-15 12:12:21.592 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:55972
2025-04-15 12:12:21.604 [main] ERROR c.r.l.m.common.JsonSerializer - Failed to deserialize message: Unrecognized field "success" (class com.rpc.lampcontrol.middleware.protocol.RegisterResponse), not marked as ignorable (5 known properties: "version", "type", "message", "traceId", "status"])
 at [Source: (String)"{"version":"1.0","type":"registerResponse","traceId":"7cd91eac-6d02-4583-ae28-1ab4139427bd","status":"success","message":"Function 'toggle' registered successfully","success":true}"; line: 1, column: 180] (through reference chain: com.rpc.lampcontrol.middleware.protocol.RegisterResponse["success"])
2025-04-15 12:12:21.605 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:8888
2025-04-15 12:12:21.605 [main] ERROR c.r.l.m.registry.RegistryClient - Error registering service: Failed to deserialize received message
2025-04-15 12:12:21.605 [main] ERROR c.r.l.application.server.ServerMain - Error registering lamp functions: Failed to register service: Failed to deserialize received message
2025-04-15 12:12:39.061 [Thread-0] INFO  c.r.l.m.registry.RegistryLauncher - Shutting down registry server...
2025-04-15 12:12:39.061 [Thread-0] INFO  c.r.l.m.registry.RegistryServer - Stopping registry server
2025-04-15 12:12:39.062 [Thread-0] INFO  c.r.l.m.transport.ServerTransport - Server stopped
2025-04-15 12:12:39.062 [Thread-0] INFO  c.r.l.m.registry.RegistryServer - Registry server stopped
2025-04-15 12:12:49.997 [main] INFO  c.r.l.m.registry.RegistryServer - Starting registry server on port 9999
2025-04-15 12:12:50.004 [main] INFO  c.r.l.m.transport.ServerTransport - Server started on port 9999
2025-04-15 12:12:50.004 [main] INFO  c.r.l.m.registry.RegistryServer - Registry server started on port 9999
2025-04-15 12:12:50.004 [main] INFO  c.r.l.m.registry.RegistryLauncher - Registry server running on port 9999. Press Ctrl+C to exit.
2025-04-15 12:12:57.226 [main] INFO  c.r.l.application.server.ServerMain - Using registry port: 9999
2025-04-15 12:12:57.228 [main] INFO  c.r.l.m.registry.RegistryClient - RegistryClient configured to use registry at localhost:9999
2025-04-15 12:12:57.229 [main] INFO  c.r.l.middleware.rpc.RpcServer - Starting RPC server on port 0
2025-04-15 12:12:57.235 [main] INFO  c.r.l.m.transport.ServerTransport - Server started on port 56304
2025-04-15 12:12:57.236 [main] INFO  c.r.l.middleware.rpc.RpcServer - RPC server started on port 56304
2025-04-15 12:12:57.236 [main] INFO  c.r.l.application.server.LampImpl - Lamp 'Main Lamp' created, initial state: OFF
2025-04-15 12:12:57.236 [main] INFO  c.r.l.middleware.rpc.RpcServer - Registered function 'toggle' locally
2025-04-15 12:12:57.236 [main] INFO  c.r.l.m.registry.RegistryClient - Registering service 'toggle' at localhost:56304 with registry at localhost:9999
2025-04-15 12:12:57.250 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:9999 (timeout: 5000 ms)
2025-04-15 12:12:57.254 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:9999
2025-04-15 12:12:57.255 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:56305
2025-04-15 12:12:57.256 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:56305
2025-04-15 12:12:57.327 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"register","traceId":"1a2e5e51-8005-4e34-a86e-f00ceb8349f1","functionName":"toggle","host":"localhost","port":56304}
2025-04-15 12:12:57.328 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Received raw message: {"version":"1.0","type":"register","traceId":"1a2e5e51-8005-4e34-a86e-f00ceb8349f1","functionName":"toggle","host":"localhost","port":56304}
2025-04-15 12:12:57.431 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Received register request for function 'toggle' at localhost:56304
2025-04-15 12:12:57.431 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Function 'toggle' registered successfully at localhost:56304
2025-04-15 12:12:57.437 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"registerResponse","traceId":"1a2e5e51-8005-4e34-a86e-f00ceb8349f1","status":"success","message":"Function 'toggle' registered successfully","success":true}
2025-04-15 12:12:57.438 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"registerResponse","traceId":"1a2e5e51-8005-4e34-a86e-f00ceb8349f1","status":"success","message":"Function 'toggle' registered successfully","success":true}
2025-04-15 12:12:57.438 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:56305
2025-04-15 12:12:57.450 [main] ERROR c.r.l.m.common.JsonSerializer - Failed to deserialize message: Unrecognized field "success" (class com.rpc.lampcontrol.middleware.protocol.RegisterResponse), not marked as ignorable (5 known properties: "version", "type", "message", "traceId", "status"])
 at [Source: (String)"{"version":"1.0","type":"registerResponse","traceId":"1a2e5e51-8005-4e34-a86e-f00ceb8349f1","status":"success","message":"Function 'toggle' registered successfully","success":true}"; line: 1, column: 180] (through reference chain: com.rpc.lampcontrol.middleware.protocol.RegisterResponse["success"])
2025-04-15 12:12:57.451 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:9999
2025-04-15 12:12:57.451 [main] ERROR c.r.l.m.registry.RegistryClient - Error registering service: Failed to deserialize received message
2025-04-15 12:12:57.451 [main] ERROR c.r.l.application.server.ServerMain - Error registering lamp functions: Failed to register service: Failed to deserialize received message
2025-04-15 12:13:08.500 [main] INFO  c.r.l.application.client.ClientMain - Using registry port: 9999
2025-04-15 12:13:08.502 [main] INFO  c.r.l.m.registry.RegistryClient - RegistryClient configured to use registry at localhost:9999
2025-04-15 12:13:36.552 [main] INFO  c.r.l.m.registry.RegistryClient - Looking up service 'toggle' in registry at localhost:9999
2025-04-15 12:13:36.572 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:9999 (timeout: 5000 ms)
2025-04-15 12:13:36.583 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:9999
2025-04-15 12:13:36.583 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:56678
2025-04-15 12:13:36.585 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:56678
2025-04-15 12:13:36.653 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"lookup","traceId":"d20ab4c8-fcfb-4072-b355-9f4e0b37d9e6","functionName":"toggle"}
2025-04-15 12:13:36.654 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Received raw message: {"version":"1.0","type":"lookup","traceId":"d20ab4c8-fcfb-4072-b355-9f4e0b37d9e6","functionName":"toggle"}
2025-04-15 12:13:36.657 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Received lookup request for function 'toggle'
2025-04-15 12:13:36.657 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Function 'toggle' found at localhost:56304
2025-04-15 12:13:36.660 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"lookupResponse","traceId":"d20ab4c8-fcfb-4072-b355-9f4e0b37d9e6","status":"success","host":"localhost","port":56304,"errorMessage":null,"success":true}
2025-04-15 12:13:36.660 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:56678
2025-04-15 12:13:36.661 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"lookupResponse","traceId":"d20ab4c8-fcfb-4072-b355-9f4e0b37d9e6","status":"success","host":"localhost","port":56304,"errorMessage":null,"success":true}
2025-04-15 12:13:36.686 [main] ERROR c.r.l.m.common.JsonSerializer - Failed to deserialize message: Unrecognized field "success" (class com.rpc.lampcontrol.middleware.protocol.LookupResponse), not marked as ignorable (7 known properties: "traceId", "port", "status", "version", "type", "errorMessage", "host"])
 at [Source: (String)"{"version":"1.0","type":"lookupResponse","traceId":"d20ab4c8-fcfb-4072-b355-9f4e0b37d9e6","status":"success","host":"localhost","port":56304,"errorMessage":null,"success":true}"; line: 1, column: 176] (through reference chain: com.rpc.lampcontrol.middleware.protocol.LookupResponse["success"])
2025-04-15 12:13:36.687 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:9999
2025-04-15 12:13:36.687 [main] ERROR c.r.l.m.registry.RegistryClient - Error looking up service: Failed to deserialize received message
2025-04-15 12:13:36.687 [main] ERROR c.r.l.middleware.rpc.RpcClient - Registry error looking up function: Failed to look up service: Failed to deserialize received message
2025-04-15 12:13:36.688 [main] ERROR c.r.l.application.client.ClientMain - RPC error: Registry error: Failed to look up service: Failed to deserialize received message
com.rpc.lampcontrol.middleware.rpc.RpcClient$RpcException: Registry error: Failed to look up service: Failed to deserialize received message
	at com.rpc.lampcontrol.middleware.rpc.RpcClient.invoke(RpcClient.java:99)
	at com.rpc.lampcontrol.middleware.rpc.RpcClient.invoke(RpcClient.java:49)
	at com.rpc.lampcontrol.application.client.ClientMain.main(ClientMain.java:67)
Caused by: com.rpc.lampcontrol.middleware.registry.RegistryClient$RegistryException: Failed to look up service: Failed to deserialize received message
	at com.rpc.lampcontrol.middleware.registry.RegistryClient.lookupService(RegistryClient.java:119)
	at com.rpc.lampcontrol.middleware.rpc.RpcClient.invoke(RpcClient.java:63)
	... 2 common frames omitted
Caused by: com.rpc.lampcontrol.middleware.transport.ConnectionHandler$ConnectionException: Failed to deserialize received message
	at com.rpc.lampcontrol.middleware.transport.ConnectionHandler.receiveMessage(ConnectionHandler.java:91)
	at com.rpc.lampcontrol.middleware.registry.RegistryClient.lookupService(RegistryClient.java:108)
	... 3 common frames omitted
Caused by: com.rpc.lampcontrol.middleware.common.JsonSerializer$SerializationException: Failed to deserialize message
	at com.rpc.lampcontrol.middleware.common.JsonSerializer.deserialize(JsonSerializer.java:101)
	at com.rpc.lampcontrol.middleware.transport.ConnectionHandler.receiveMessage(ConnectionHandler.java:87)
	... 4 common frames omitted
Caused by: com.fasterxml.jackson.databind.exc.UnrecognizedPropertyException: Unrecognized field "success" (class com.rpc.lampcontrol.middleware.protocol.LookupResponse), not marked as ignorable (7 known properties: "traceId", "port", "status", "version", "type", "errorMessage", "host"])
 at [Source: (String)"{"version":"1.0","type":"lookupResponse","traceId":"d20ab4c8-fcfb-4072-b355-9f4e0b37d9e6","status":"success","host":"localhost","port":56304,"errorMessage":null,"success":true}"; line: 1, column: 176] (through reference chain: com.rpc.lampcontrol.middleware.protocol.LookupResponse["success"])
	at com.fasterxml.jackson.databind.exc.UnrecognizedPropertyException.from(UnrecognizedPropertyException.java:61)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnknownProperty(DeserializationContext.java:1138)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer.handleUnknownProperty(StdDeserializer.java:2224)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.handleUnknownProperty(BeanDeserializerBase.java:1709)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.handleUnknownVanilla(BeanDeserializerBase.java:1687)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:320)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4825)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3772)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3740)
	at com.rpc.lampcontrol.middleware.common.JsonSerializer.deserialize(JsonSerializer.java:98)
	... 5 common frames omitted
2025-04-15 12:15:58.687 [Thread-0] INFO  c.r.l.m.registry.RegistryLauncher - Shutting down registry server...
2025-04-15 12:15:58.690 [Thread-0] INFO  c.r.l.m.registry.RegistryServer - Stopping registry server
2025-04-15 12:15:58.691 [Thread-0] INFO  c.r.l.m.transport.ServerTransport - Server stopped
2025-04-15 12:15:58.691 [Thread-0] INFO  c.r.l.m.registry.RegistryServer - Registry server stopped
2025-04-15 12:16:06.940 [main] INFO  c.r.l.m.registry.RegistryServer - Starting registry server on port 9999
2025-04-15 12:16:06.946 [main] INFO  c.r.l.m.transport.ServerTransport - Server started on port 9999
2025-04-15 12:16:06.947 [main] INFO  c.r.l.m.registry.RegistryServer - Registry server started on port 9999
2025-04-15 12:16:06.947 [main] INFO  c.r.l.m.registry.RegistryLauncher - Registry server running on port 9999. Press Ctrl+C to exit.
2025-04-15 12:16:19.338 [main] INFO  c.r.l.application.server.ServerMain - Using registry port: 9999
2025-04-15 12:16:19.340 [main] INFO  c.r.l.m.registry.RegistryClient - RegistryClient configured to use registry at localhost:9999
2025-04-15 12:16:19.341 [main] INFO  c.r.l.middleware.rpc.RpcServer - Starting RPC server on port 0
2025-04-15 12:16:19.347 [main] INFO  c.r.l.m.transport.ServerTransport - Server started on port 58222
2025-04-15 12:16:19.348 [main] INFO  c.r.l.middleware.rpc.RpcServer - RPC server started on port 58222
2025-04-15 12:16:19.348 [main] INFO  c.r.l.application.server.LampImpl - Lamp 'Main Lamp' created, initial state: OFF
2025-04-15 12:16:19.348 [main] INFO  c.r.l.middleware.rpc.RpcServer - Registered function 'toggle' locally
2025-04-15 12:16:19.348 [main] INFO  c.r.l.m.registry.RegistryClient - Registering service 'toggle' at localhost:58222 with registry at localhost:9999
2025-04-15 12:16:19.362 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:9999 (timeout: 5000 ms)
2025-04-15 12:16:19.367 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:9999
2025-04-15 12:16:19.368 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:58223
2025-04-15 12:16:19.370 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:58223
2025-04-15 12:16:19.439 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"register","traceId":"f00aaa57-222c-4e1f-9d66-5dd867497fd6","functionName":"toggle","host":"localhost","port":58222}
2025-04-15 12:16:19.440 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Received raw message: {"version":"1.0","type":"register","traceId":"f00aaa57-222c-4e1f-9d66-5dd867497fd6","functionName":"toggle","host":"localhost","port":58222}
2025-04-15 12:16:19.532 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Received register request for function 'toggle' at localhost:58222
2025-04-15 12:16:19.532 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Function 'toggle' registered successfully at localhost:58222
2025-04-15 12:16:19.538 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"registerResponse","traceId":"f00aaa57-222c-4e1f-9d66-5dd867497fd6","status":"success","message":"Function 'toggle' registered successfully","success":true}
2025-04-15 12:16:19.539 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"registerResponse","traceId":"f00aaa57-222c-4e1f-9d66-5dd867497fd6","status":"success","message":"Function 'toggle' registered successfully","success":true}
2025-04-15 12:16:19.540 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:58223
2025-04-15 12:16:19.550 [main] ERROR c.r.l.m.common.JsonSerializer - Failed to deserialize message: Unrecognized field "success" (class com.rpc.lampcontrol.middleware.protocol.RegisterResponse), not marked as ignorable (5 known properties: "version", "type", "message", "traceId", "status"])
 at [Source: (String)"{"version":"1.0","type":"registerResponse","traceId":"f00aaa57-222c-4e1f-9d66-5dd867497fd6","status":"success","message":"Function 'toggle' registered successfully","success":true}"; line: 1, column: 180] (through reference chain: com.rpc.lampcontrol.middleware.protocol.RegisterResponse["success"])
2025-04-15 12:16:19.551 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:9999
2025-04-15 12:16:19.551 [main] ERROR c.r.l.m.registry.RegistryClient - Error registering service: Failed to deserialize received message
2025-04-15 12:16:19.551 [main] ERROR c.r.l.application.server.ServerMain - Error registering lamp functions: Failed to register service: Failed to deserialize received message
2025-04-15 12:16:31.371 [main] INFO  c.r.l.application.client.ClientMain - Using registry port: 9999
2025-04-15 12:16:31.373 [main] INFO  c.r.l.m.registry.RegistryClient - RegistryClient configured to use registry at localhost:9999
2025-04-15 12:16:38.667 [main] INFO  c.r.l.m.registry.RegistryClient - Looking up service 'toggle' in registry at localhost:9999
2025-04-15 12:16:38.698 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:9999 (timeout: 5000 ms)
2025-04-15 12:16:38.712 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:9999
2025-04-15 12:16:38.711 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:58409
2025-04-15 12:16:38.714 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:58409
2025-04-15 12:16:38.788 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"lookup","traceId":"e3064609-30d0-4b36-be7e-588a04c970ea","functionName":"toggle"}
2025-04-15 12:16:38.788 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Received raw message: {"version":"1.0","type":"lookup","traceId":"e3064609-30d0-4b36-be7e-588a04c970ea","functionName":"toggle"}
2025-04-15 12:16:38.791 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Received lookup request for function 'toggle'
2025-04-15 12:16:38.791 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Function 'toggle' found at localhost:58222
2025-04-15 12:16:38.801 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"lookupResponse","traceId":"e3064609-30d0-4b36-be7e-588a04c970ea","status":"success","host":"localhost","port":58222,"errorMessage":null}
2025-04-15 12:16:38.801 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:58409
2025-04-15 12:16:38.801 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"lookupResponse","traceId":"e3064609-30d0-4b36-be7e-588a04c970ea","status":"success","host":"localhost","port":58222,"errorMessage":null}
2025-04-15 12:16:38.820 [main] INFO  c.r.l.m.registry.RegistryClient - Service 'toggle' found at localhost:58222
2025-04-15 12:16:38.821 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:9999
2025-04-15 12:16:38.822 [main] INFO  c.r.l.middleware.rpc.RpcClient - Invoking function 'toggle' at localhost:58222
2025-04-15 12:16:38.822 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:58222 (timeout: 5000 ms)
2025-04-15 12:16:38.822 [main] ERROR c.r.l.m.transport.ClientTransport - Failed to connect to localhost:58222: Connection refused
2025-04-15 12:16:38.822 [main] ERROR c.r.l.middleware.rpc.RpcClient - Network error invoking function: Failed to connect to localhost:58222
2025-04-15 12:16:38.822 [main] ERROR c.r.l.application.client.ClientMain - RPC error: Network error: Failed to connect to localhost:58222
com.rpc.lampcontrol.middleware.rpc.RpcClient$RpcException: Network error: Failed to connect to localhost:58222
	at com.rpc.lampcontrol.middleware.rpc.RpcClient.invoke(RpcClient.java:93)
	at com.rpc.lampcontrol.middleware.rpc.RpcClient.invoke(RpcClient.java:49)
	at com.rpc.lampcontrol.application.client.ClientMain.main(ClientMain.java:67)
Caused by: java.io.IOException: Failed to connect to localhost:58222
	at com.rpc.lampcontrol.middleware.transport.ClientTransport.connect(ClientTransport.java:46)
	at com.rpc.lampcontrol.middleware.transport.ClientTransport.connect(ClientTransport.java:25)
	at com.rpc.lampcontrol.middleware.rpc.RpcClient.invoke(RpcClient.java:78)
	... 2 common frames omitted
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.connect0(Native Method)
	at java.base/sun.nio.ch.Net.connect(Net.java:589)
	at java.base/sun.nio.ch.Net.connect(Net.java:578)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:583)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327)
	at java.base/java.net.Socket.connect(Socket.java:760)
	at java.base/java.net.Socket.connect(Socket.java:695)
	at java.base/java.net.Socket.<init>(Socket.java:564)
	at java.base/java.net.Socket.<init>(Socket.java:328)
	at com.rpc.lampcontrol.middleware.transport.ClientTransport.connect(ClientTransport.java:41)
	... 4 common frames omitted
2025-04-15 12:32:18.052 [Thread-0] INFO  c.r.l.m.registry.RegistryLauncher - Shutting down registry server...
2025-04-15 12:32:18.056 [Thread-0] INFO  c.r.l.m.registry.RegistryServer - Stopping registry server
2025-04-15 12:32:18.058 [Thread-0] INFO  c.r.l.m.transport.ServerTransport - Server stopped
2025-04-15 12:32:18.058 [Thread-0] INFO  c.r.l.m.registry.RegistryServer - Registry server stopped
2025-04-15 12:32:44.041 [main] INFO  c.r.l.m.registry.RegistryServer - Starting registry server on port 7777
2025-04-15 12:32:44.051 [main] INFO  c.r.l.m.transport.ServerTransport - Server started on port 7777
2025-04-15 12:32:44.051 [main] INFO  c.r.l.m.registry.RegistryServer - Registry server started on port 7777
2025-04-15 12:32:44.052 [main] INFO  c.r.l.m.registry.RegistryLauncher - Registry server running on port 7777. Press Ctrl+C to exit.
2025-04-15 12:32:51.775 [main] INFO  c.r.l.m.registry.RegistryClient - RegistryClient configured to use registry at localhost:7777
2025-04-15 12:32:51.777 [main] INFO  c.r.l.middleware.rpc.RpcServer - Starting RPC server on port 0
2025-04-15 12:32:51.783 [main] INFO  c.r.l.m.transport.ServerTransport - Server started on port 51248
2025-04-15 12:32:51.784 [main] INFO  c.r.l.middleware.rpc.RpcServer - RPC server started on port 51248
2025-04-15 12:32:51.784 [main] INFO  c.r.l.application.server.LampImpl - Lamp 'Main Lamp' created, initial state: OFF
2025-04-15 12:32:51.784 [main] INFO  c.r.l.middleware.rpc.RpcServer - Registered function 'toggle' locally
2025-04-15 12:32:51.784 [main] INFO  c.r.l.m.registry.RegistryClient - Registering service 'toggle' at localhost:51248 with registry at localhost:7777
2025-04-15 12:32:51.801 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:7777 (timeout: 5000 ms)
2025-04-15 12:32:51.807 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:7777
2025-04-15 12:32:51.806 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:51249
2025-04-15 12:32:51.808 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:51249
2025-04-15 12:32:51.877 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"register","traceId":"55f3212b-3a4b-4f2e-8e03-871272c0f811","functionName":"toggle","host":"localhost","port":51248}
2025-04-15 12:32:51.878 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Received raw message: {"version":"1.0","type":"register","traceId":"55f3212b-3a4b-4f2e-8e03-871272c0f811","functionName":"toggle","host":"localhost","port":51248}
2025-04-15 12:32:51.968 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Received register request for function 'toggle' at localhost:51248
2025-04-15 12:32:51.968 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Function 'toggle' registered successfully at localhost:51248
2025-04-15 12:32:51.974 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"registerResponse","traceId":"55f3212b-3a4b-4f2e-8e03-871272c0f811","status":"success","message":"Function 'toggle' registered successfully","success":true}
2025-04-15 12:32:51.974 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"registerResponse","traceId":"55f3212b-3a4b-4f2e-8e03-871272c0f811","status":"success","message":"Function 'toggle' registered successfully","success":true}
2025-04-15 12:32:51.975 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:51249
2025-04-15 12:32:51.986 [main] ERROR c.r.l.m.common.JsonSerializer - Failed to deserialize message: Unrecognized field "success" (class com.rpc.lampcontrol.middleware.protocol.RegisterResponse), not marked as ignorable (5 known properties: "version", "type", "message", "traceId", "status"])
 at [Source: (String)"{"version":"1.0","type":"registerResponse","traceId":"55f3212b-3a4b-4f2e-8e03-871272c0f811","status":"success","message":"Function 'toggle' registered successfully","success":true}"; line: 1, column: 180] (through reference chain: com.rpc.lampcontrol.middleware.protocol.RegisterResponse["success"])
2025-04-15 12:32:51.986 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:7777
2025-04-15 12:32:51.987 [main] ERROR c.r.l.m.registry.RegistryClient - Error registering service: Failed to deserialize received message
2025-04-15 12:32:51.987 [main] ERROR c.r.l.application.server.ServerMain - Error registering lamp functions: Failed to register service: Failed to deserialize received message
2025-04-15 12:32:58.262 [main] INFO  c.r.l.m.registry.RegistryClient - RegistryClient configured to use registry at localhost:7777
2025-04-15 12:32:58.264 [main] INFO  c.r.l.middleware.rpc.RpcServer - Starting RPC server on port 0
2025-04-15 12:32:58.270 [main] INFO  c.r.l.m.transport.ServerTransport - Server started on port 51330
2025-04-15 12:32:58.270 [main] INFO  c.r.l.middleware.rpc.RpcServer - RPC server started on port 51330
2025-04-15 12:32:58.271 [main] INFO  c.r.l.application.server.LampImpl - Lamp 'Main Lamp' created, initial state: OFF
2025-04-15 12:32:58.271 [main] INFO  c.r.l.middleware.rpc.RpcServer - Registered function 'toggle' locally
2025-04-15 12:32:58.271 [main] INFO  c.r.l.m.registry.RegistryClient - Registering service 'toggle' at localhost:51330 with registry at localhost:7777
2025-04-15 12:32:58.285 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:7777 (timeout: 5000 ms)
2025-04-15 12:32:58.288 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:51331
2025-04-15 12:32:58.288 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:51331
2025-04-15 12:32:58.288 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:7777
2025-04-15 12:32:58.349 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"register","traceId":"e4ce829a-b9a9-4bdc-b2cd-b2f565eb9767","functionName":"toggle","host":"localhost","port":51330}
2025-04-15 12:32:58.350 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Received raw message: {"version":"1.0","type":"register","traceId":"e4ce829a-b9a9-4bdc-b2cd-b2f565eb9767","functionName":"toggle","host":"localhost","port":51330}
2025-04-15 12:32:58.350 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Received register request for function 'toggle' at localhost:51330
2025-04-15 12:32:58.350 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Function 'toggle' already registered, updating to localhost:51330
2025-04-15 12:32:58.351 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"registerResponse","traceId":"e4ce829a-b9a9-4bdc-b2cd-b2f565eb9767","status":"success","message":"Function 'toggle' registration updated","success":true}
2025-04-15 12:32:58.351 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:51331
2025-04-15 12:32:58.351 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"registerResponse","traceId":"e4ce829a-b9a9-4bdc-b2cd-b2f565eb9767","status":"success","message":"Function 'toggle' registration updated","success":true}
2025-04-15 12:32:58.362 [main] ERROR c.r.l.m.common.JsonSerializer - Failed to deserialize message: Unrecognized field "success" (class com.rpc.lampcontrol.middleware.protocol.RegisterResponse), not marked as ignorable (5 known properties: "version", "type", "message", "traceId", "status"])
 at [Source: (String)"{"version":"1.0","type":"registerResponse","traceId":"e4ce829a-b9a9-4bdc-b2cd-b2f565eb9767","status":"success","message":"Function 'toggle' registration updated","success":true}"; line: 1, column: 177] (through reference chain: com.rpc.lampcontrol.middleware.protocol.RegisterResponse["success"])
2025-04-15 12:32:58.363 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:7777
2025-04-15 12:32:58.363 [main] ERROR c.r.l.m.registry.RegistryClient - Error registering service: Failed to deserialize received message
2025-04-15 12:32:58.363 [main] ERROR c.r.l.application.server.ServerMain - Error registering lamp functions: Failed to register service: Failed to deserialize received message
2025-04-15 12:55:00.119 [Thread-0] INFO  c.r.l.m.registry.RegistryLauncher - Shutting down registry server...
2025-04-15 12:55:00.120 [Thread-0] INFO  c.r.l.m.registry.RegistryServer - Stopping registry server
2025-04-15 12:55:00.122 [Thread-0] INFO  c.r.l.m.transport.ServerTransport - Server stopped
2025-04-15 12:55:00.123 [Thread-0] INFO  c.r.l.m.registry.RegistryServer - Registry server stopped
2025-04-15 14:12:54.454 [main] INFO  c.r.l.m.registry.RegistryServer - Starting registry server on port 9999
2025-04-15 14:12:54.467 [main] INFO  c.r.l.m.transport.ServerTransport - Server started on port 9999
2025-04-15 14:12:54.468 [main] INFO  c.r.l.m.registry.RegistryServer - Registry server started on port 9999
2025-04-15 14:12:54.468 [main] INFO  c.r.l.m.registry.RegistryLauncher - Registry server running on port 9999. Press Ctrl+C to exit.
2025-04-15 14:13:01.702 [main] INFO  c.r.l.application.server.ServerMain - Using registry port: 9999
2025-04-15 14:13:01.704 [main] INFO  c.r.l.m.registry.RegistryClient - RegistryClient configured to use registry at localhost:9999
2025-04-15 14:13:01.705 [main] INFO  c.r.l.middleware.rpc.RpcServer - Starting RPC server on port 0
2025-04-15 14:13:01.712 [main] INFO  c.r.l.m.transport.ServerTransport - Server started on port 58087
2025-04-15 14:13:01.712 [main] INFO  c.r.l.middleware.rpc.RpcServer - RPC server started on port 58087
2025-04-15 14:13:01.712 [main] INFO  c.r.l.application.server.LampImpl - Lamp 'Main Lamp' created, initial state: OFF
2025-04-15 14:13:01.713 [main] INFO  c.r.l.middleware.rpc.RpcServer - Registered function 'toggle' locally
2025-04-15 14:13:01.713 [main] INFO  c.r.l.m.registry.RegistryClient - Registering service 'toggle' at localhost:58087 with registry at localhost:9999
2025-04-15 14:13:01.726 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:9999 (timeout: 5000 ms)
2025-04-15 14:13:01.730 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:9999
2025-04-15 14:13:01.731 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:58088
2025-04-15 14:13:01.733 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:58088
2025-04-15 14:13:01.797 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"register","traceId":"01376dd8-6dd4-4ea8-aae1-1d98e48d111b","functionName":"toggle","host":"localhost","port":58087}
2025-04-15 14:13:01.798 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Received raw message: {"version":"1.0","type":"register","traceId":"01376dd8-6dd4-4ea8-aae1-1d98e48d111b","functionName":"toggle","host":"localhost","port":58087}
2025-04-15 14:13:01.892 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Received register request for function 'toggle' at localhost:58087
2025-04-15 14:13:01.892 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Function 'toggle' registered successfully at localhost:58087
2025-04-15 14:13:01.901 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"registerResponse","traceId":"01376dd8-6dd4-4ea8-aae1-1d98e48d111b","status":"success","message":"Function 'toggle' registered successfully"}
2025-04-15 14:13:01.902 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"registerResponse","traceId":"01376dd8-6dd4-4ea8-aae1-1d98e48d111b","status":"success","message":"Function 'toggle' registered successfully"}
2025-04-15 14:13:01.902 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:58088
2025-04-15 14:13:01.917 [main] INFO  c.r.l.m.registry.RegistryClient - Service 'toggle' registered successfully: Function 'toggle' registered successfully
2025-04-15 14:13:01.919 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:9999
2025-04-15 14:13:01.919 [main] INFO  c.r.l.middleware.rpc.RpcServer - Registered function 'toggle' with registry at localhost:58087
2025-04-15 14:13:01.919 [main] INFO  c.r.l.middleware.rpc.RpcServer - Registered function 'isOn' locally
2025-04-15 14:13:01.919 [main] INFO  c.r.l.m.registry.RegistryClient - Registering service 'isOn' at localhost:58087 with registry at localhost:9999
2025-04-15 14:13:01.919 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:9999 (timeout: 5000 ms)
2025-04-15 14:13:01.919 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:9999
2025-04-15 14:13:01.919 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:58089
2025-04-15 14:13:01.920 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"register","traceId":"c1c6411f-e6e4-4eb9-af28-d0bf893fe7ba","functionName":"isOn","host":"localhost","port":58087}
2025-04-15 14:13:01.920 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:58089
2025-04-15 14:13:01.920 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Received raw message: {"version":"1.0","type":"register","traceId":"c1c6411f-e6e4-4eb9-af28-d0bf893fe7ba","functionName":"isOn","host":"localhost","port":58087}
2025-04-15 14:13:01.920 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Received register request for function 'isOn' at localhost:58087
2025-04-15 14:13:01.920 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Function 'isOn' registered successfully at localhost:58087
2025-04-15 14:13:01.920 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"registerResponse","traceId":"c1c6411f-e6e4-4eb9-af28-d0bf893fe7ba","status":"success","message":"Function 'isOn' registered successfully"}
2025-04-15 14:13:01.920 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:58089
2025-04-15 14:13:01.921 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"registerResponse","traceId":"c1c6411f-e6e4-4eb9-af28-d0bf893fe7ba","status":"success","message":"Function 'isOn' registered successfully"}
2025-04-15 14:13:01.921 [main] INFO  c.r.l.m.registry.RegistryClient - Service 'isOn' registered successfully: Function 'isOn' registered successfully
2025-04-15 14:13:01.921 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:9999
2025-04-15 14:13:01.921 [main] INFO  c.r.l.middleware.rpc.RpcServer - Registered function 'isOn' with registry at localhost:58087
2025-04-15 14:13:01.921 [main] INFO  c.r.l.application.server.ServerMain - Lamp server started on port 58087. Press Ctrl+C to exit.
2025-04-15 14:14:46.089 [main] INFO  c.r.l.application.client.ClientMain - Using registry port: 9999
2025-04-15 14:14:46.090 [main] INFO  c.r.l.m.registry.RegistryClient - RegistryClient configured to use registry at localhost:9999
2025-04-15 14:14:51.498 [main] INFO  c.r.l.m.registry.RegistryClient - Looking up service 'toggle' in registry at localhost:9999
2025-04-15 14:14:51.516 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:9999 (timeout: 5000 ms)
2025-04-15 14:14:51.527 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:9999
2025-04-15 14:14:51.527 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:59106
2025-04-15 14:14:51.533 [pool-1-thread-3] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:59106
2025-04-15 14:14:51.602 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"lookup","traceId":"97a91dba-21f0-44e5-9263-6bda1ae1a6b5","functionName":"toggle"}
2025-04-15 14:14:51.602 [pool-1-thread-3] DEBUG c.r.l.m.transport.ConnectionHandler - Received raw message: {"version":"1.0","type":"lookup","traceId":"97a91dba-21f0-44e5-9263-6bda1ae1a6b5","functionName":"toggle"}
2025-04-15 14:14:51.605 [pool-1-thread-3] INFO  c.r.l.m.registry.RegistryServer - Received lookup request for function 'toggle'
2025-04-15 14:14:51.606 [pool-1-thread-3] INFO  c.r.l.m.registry.RegistryServer - Function 'toggle' found at localhost:58087
2025-04-15 14:14:51.610 [pool-1-thread-3] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"lookupResponse","traceId":"97a91dba-21f0-44e5-9263-6bda1ae1a6b5","status":"success","host":"localhost","port":58087,"errorMessage":null}
2025-04-15 14:14:51.610 [pool-1-thread-3] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:59106
2025-04-15 14:14:51.611 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"lookupResponse","traceId":"97a91dba-21f0-44e5-9263-6bda1ae1a6b5","status":"success","host":"localhost","port":58087,"errorMessage":null}
2025-04-15 14:14:51.629 [main] INFO  c.r.l.m.registry.RegistryClient - Service 'toggle' found at localhost:58087
2025-04-15 14:14:51.630 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:9999
2025-04-15 14:14:51.630 [main] INFO  c.r.l.middleware.rpc.RpcClient - Invoking function 'toggle' at localhost:58087
2025-04-15 14:14:51.630 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:58087 (timeout: 5000 ms)
2025-04-15 14:14:51.630 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:58087
2025-04-15 14:14:51.633 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"request","traceId":"499d68bf-33ae-4f23-9be9-9ad762e8f12a","functionName":"toggle","arguments":[]}
2025-04-15 14:14:51.631 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:59107
2025-04-15 14:14:51.637 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:59107
2025-04-15 14:14:51.638 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"request","traceId":"499d68bf-33ae-4f23-9be9-9ad762e8f12a","functionName":"toggle","arguments":[]}
2025-04-15 14:14:51.648 [pool-1-thread-2] INFO  c.r.l.middleware.rpc.RpcServer - Received RPC request for function 'toggle' with 0 arguments
2025-04-15 14:14:51.648 [pool-1-thread-2] INFO  c.r.l.application.server.LampImpl - Lamp 'Main Lamp' toggled to: ON
2025-04-15 14:14:51.649 [pool-1-thread-2] INFO  c.r.l.middleware.rpc.RpcServer - Function 'toggle' invoked successfully
2025-04-15 14:14:51.653 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"response","traceId":"499d68bf-33ae-4f23-9be9-9ad762e8f12a","status":"success","result":"Lamp 'Main Lamp' is now ON","errorMessage":null,"success":true}
2025-04-15 14:14:51.653 [pool-1-thread-2] INFO  c.r.l.middleware.rpc.RpcServer - Sent RPC response for function 'toggle'
2025-04-15 14:14:51.653 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:59107
2025-04-15 14:14:51.653 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"response","traceId":"499d68bf-33ae-4f23-9be9-9ad762e8f12a","status":"success","result":"Lamp 'Main Lamp' is now ON","errorMessage":null,"success":true}
2025-04-15 14:14:51.658 [main] ERROR c.r.l.m.common.JsonSerializer - Failed to deserialize message: Unrecognized field "success" (class com.rpc.lampcontrol.middleware.protocol.RpcResponse), not marked as ignorable (6 known properties: "traceId", "status", "version", "type", "result", "errorMessage"])
 at [Source: (String)"{"version":"1.0","type":"response","traceId":"499d68bf-33ae-4f23-9be9-9ad762e8f12a","status":"success","result":"Lamp 'Main Lamp' is now ON","errorMessage":null,"success":true}"; line: 1, column: 176] (through reference chain: com.rpc.lampcontrol.middleware.protocol.RpcResponse["success"])
2025-04-15 14:14:51.658 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:58087
2025-04-15 14:14:51.658 [main] ERROR c.r.l.middleware.rpc.RpcClient - Communication error invoking function: Failed to deserialize received message
2025-04-15 14:14:51.658 [main] ERROR c.r.l.application.client.ClientMain - RPC error: Communication error: Failed to deserialize received message
com.rpc.lampcontrol.middleware.rpc.RpcClient$RpcException: Communication error: Failed to deserialize received message
	at com.rpc.lampcontrol.middleware.rpc.RpcClient.invoke(RpcClient.java:96)
	at com.rpc.lampcontrol.middleware.rpc.RpcClient.invoke(RpcClient.java:49)
	at com.rpc.lampcontrol.application.client.ClientMain.main(ClientMain.java:67)
Caused by: com.rpc.lampcontrol.middleware.transport.ConnectionHandler$ConnectionException: Failed to deserialize received message
	at com.rpc.lampcontrol.middleware.transport.ConnectionHandler.receiveMessage(ConnectionHandler.java:91)
	at com.rpc.lampcontrol.middleware.rpc.RpcClient.invoke(RpcClient.java:80)
	... 2 common frames omitted
Caused by: com.rpc.lampcontrol.middleware.common.JsonSerializer$SerializationException: Failed to deserialize message
	at com.rpc.lampcontrol.middleware.common.JsonSerializer.deserialize(JsonSerializer.java:101)
	at com.rpc.lampcontrol.middleware.transport.ConnectionHandler.receiveMessage(ConnectionHandler.java:87)
	... 3 common frames omitted
Caused by: com.fasterxml.jackson.databind.exc.UnrecognizedPropertyException: Unrecognized field "success" (class com.rpc.lampcontrol.middleware.protocol.RpcResponse), not marked as ignorable (6 known properties: "traceId", "status", "version", "type", "result", "errorMessage"])
 at [Source: (String)"{"version":"1.0","type":"response","traceId":"499d68bf-33ae-4f23-9be9-9ad762e8f12a","status":"success","result":"Lamp 'Main Lamp' is now ON","errorMessage":null,"success":true}"; line: 1, column: 176] (through reference chain: com.rpc.lampcontrol.middleware.protocol.RpcResponse["success"])
	at com.fasterxml.jackson.databind.exc.UnrecognizedPropertyException.from(UnrecognizedPropertyException.java:61)
	at com.fasterxml.jackson.databind.DeserializationContext.handleUnknownProperty(DeserializationContext.java:1138)
	at com.fasterxml.jackson.databind.deser.std.StdDeserializer.handleUnknownProperty(StdDeserializer.java:2224)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.handleUnknownProperty(BeanDeserializerBase.java:1709)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.handleUnknownVanilla(BeanDeserializerBase.java:1687)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:320)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:177)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4825)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3772)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3740)
	at com.rpc.lampcontrol.middleware.common.JsonSerializer.deserialize(JsonSerializer.java:98)
	... 4 common frames omitted
2025-04-15 14:40:22.324 [Thread-0] INFO  c.r.l.m.registry.RegistryLauncher - Shutting down registry server...
2025-04-15 14:40:22.324 [Thread-0] INFO  c.r.l.application.server.ServerMain - Shutting down lamp server...
2025-04-15 14:40:22.327 [Thread-0] INFO  c.r.l.m.registry.RegistryServer - Stopping registry server
2025-04-15 14:40:22.327 [Thread-0] INFO  c.r.l.middleware.rpc.RpcServer - Stopping RPC server
2025-04-15 14:40:22.328 [Thread-0] INFO  c.r.l.m.transport.ServerTransport - Server stopped
2025-04-15 14:40:22.328 [Thread-0] INFO  c.r.l.m.transport.ServerTransport - Server stopped
2025-04-15 14:40:22.328 [Thread-0] INFO  c.r.l.middleware.rpc.RpcServer - RPC server stopped
2025-04-15 14:40:22.328 [Thread-0] INFO  c.r.l.m.registry.RegistryServer - Registry server stopped
2025-04-15 14:40:34.256 [main] INFO  c.r.l.m.registry.RegistryServer - Starting registry server on port 9999
2025-04-15 14:40:34.264 [main] INFO  c.r.l.m.transport.ServerTransport - Server started on port 9999
2025-04-15 14:40:34.265 [main] INFO  c.r.l.m.registry.RegistryServer - Registry server started on port 9999
2025-04-15 14:40:34.265 [main] INFO  c.r.l.m.registry.RegistryLauncher - Registry server running on port 9999. Press Ctrl+C to exit.
2025-04-15 14:40:53.023 [main] INFO  c.r.l.application.server.ServerMain - Using registry port: 9999
2025-04-15 14:40:53.025 [main] INFO  c.r.l.m.registry.RegistryClient - RegistryClient configured to use registry at localhost:9999
2025-04-15 14:40:53.026 [main] INFO  c.r.l.middleware.rpc.RpcServer - Starting RPC server on port 0
2025-04-15 14:40:53.032 [main] INFO  c.r.l.m.transport.ServerTransport - Server started on port 57127
2025-04-15 14:40:53.032 [main] INFO  c.r.l.middleware.rpc.RpcServer - RPC server started on port 57127
2025-04-15 14:40:53.033 [main] INFO  c.r.l.application.server.LampImpl - Lamp 'Main Lamp' created, initial state: OFF
2025-04-15 14:40:53.033 [main] INFO  c.r.l.middleware.rpc.RpcServer - Registered function 'toggle' locally
2025-04-15 14:40:53.033 [main] INFO  c.r.l.m.registry.RegistryClient - Registering service 'toggle' at localhost:57127 with registry at localhost:9999
2025-04-15 14:40:53.046 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:9999 (timeout: 5000 ms)
2025-04-15 14:40:53.050 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:9999
2025-04-15 14:40:53.051 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:57128
2025-04-15 14:40:53.052 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:57128
2025-04-15 14:40:53.118 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"register","traceId":"b7988334-ea30-483a-9901-6eaf346cf579","functionName":"toggle","host":"localhost","port":57127}
2025-04-15 14:40:53.119 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Received raw message: {"version":"1.0","type":"register","traceId":"b7988334-ea30-483a-9901-6eaf346cf579","functionName":"toggle","host":"localhost","port":57127}
2025-04-15 14:40:53.212 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Received register request for function 'toggle' at localhost:57127
2025-04-15 14:40:53.212 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Function 'toggle' registered successfully at localhost:57127
2025-04-15 14:40:53.221 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"registerResponse","traceId":"b7988334-ea30-483a-9901-6eaf346cf579","status":"success","message":"Function 'toggle' registered successfully"}
2025-04-15 14:40:53.222 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"registerResponse","traceId":"b7988334-ea30-483a-9901-6eaf346cf579","status":"success","message":"Function 'toggle' registered successfully"}
2025-04-15 14:40:53.222 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:57128
2025-04-15 14:40:53.237 [main] INFO  c.r.l.m.registry.RegistryClient - Service 'toggle' registered successfully: Function 'toggle' registered successfully
2025-04-15 14:40:53.238 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:9999
2025-04-15 14:40:53.238 [main] INFO  c.r.l.middleware.rpc.RpcServer - Registered function 'toggle' with registry at localhost:57127
2025-04-15 14:40:53.239 [main] INFO  c.r.l.middleware.rpc.RpcServer - Registered function 'isOn' locally
2025-04-15 14:40:53.239 [main] INFO  c.r.l.m.registry.RegistryClient - Registering service 'isOn' at localhost:57127 with registry at localhost:9999
2025-04-15 14:40:53.239 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:9999 (timeout: 5000 ms)
2025-04-15 14:40:53.239 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:9999
2025-04-15 14:40:53.239 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"register","traceId":"49371a0f-2735-40aa-8665-10570fa18897","functionName":"isOn","host":"localhost","port":57127}
2025-04-15 14:40:53.239 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:57129
2025-04-15 14:40:53.240 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:57129
2025-04-15 14:40:53.240 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Received raw message: {"version":"1.0","type":"register","traceId":"49371a0f-2735-40aa-8665-10570fa18897","functionName":"isOn","host":"localhost","port":57127}
2025-04-15 14:40:53.240 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Received register request for function 'isOn' at localhost:57127
2025-04-15 14:40:53.240 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Function 'isOn' registered successfully at localhost:57127
2025-04-15 14:40:53.240 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"registerResponse","traceId":"49371a0f-2735-40aa-8665-10570fa18897","status":"success","message":"Function 'isOn' registered successfully"}
2025-04-15 14:40:53.241 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:57129
2025-04-15 14:40:53.241 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"registerResponse","traceId":"49371a0f-2735-40aa-8665-10570fa18897","status":"success","message":"Function 'isOn' registered successfully"}
2025-04-15 14:40:53.241 [main] INFO  c.r.l.m.registry.RegistryClient - Service 'isOn' registered successfully: Function 'isOn' registered successfully
2025-04-15 14:40:53.241 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:9999
2025-04-15 14:40:53.241 [main] INFO  c.r.l.middleware.rpc.RpcServer - Registered function 'isOn' with registry at localhost:57127
2025-04-15 14:40:53.241 [main] INFO  c.r.l.application.server.ServerMain - Lamp server started on port 57127. Press Ctrl+C to exit.
2025-04-15 14:41:13.263 [main] INFO  c.r.l.application.client.ClientMain - Using registry port: 9999
2025-04-15 14:41:13.264 [main] INFO  c.r.l.m.registry.RegistryClient - RegistryClient configured to use registry at localhost:9999
2025-04-15 14:41:27.807 [main] INFO  c.r.l.m.registry.RegistryClient - Looking up service 'toggle' in registry at localhost:9999
2025-04-15 14:41:27.838 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:9999 (timeout: 5000 ms)
2025-04-15 14:41:27.853 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:9999
2025-04-15 14:41:27.853 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:57431
2025-04-15 14:41:27.855 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:57431
2025-04-15 14:41:27.927 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"lookup","traceId":"e99912e0-3d9c-4732-9327-9a6d17d09bce","functionName":"toggle"}
2025-04-15 14:41:27.928 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Received raw message: {"version":"1.0","type":"lookup","traceId":"e99912e0-3d9c-4732-9327-9a6d17d09bce","functionName":"toggle"}
2025-04-15 14:41:27.930 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Received lookup request for function 'toggle'
2025-04-15 14:41:27.930 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Function 'toggle' found at localhost:57127
2025-04-15 14:41:27.933 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"lookupResponse","traceId":"e99912e0-3d9c-4732-9327-9a6d17d09bce","status":"success","host":"localhost","port":57127,"errorMessage":null}
2025-04-15 14:41:27.934 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:57431
2025-04-15 14:41:27.934 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"lookupResponse","traceId":"e99912e0-3d9c-4732-9327-9a6d17d09bce","status":"success","host":"localhost","port":57127,"errorMessage":null}
2025-04-15 14:41:27.954 [main] INFO  c.r.l.m.registry.RegistryClient - Service 'toggle' found at localhost:57127
2025-04-15 14:41:27.955 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:9999
2025-04-15 14:41:27.955 [main] INFO  c.r.l.middleware.rpc.RpcClient - Invoking function 'toggle' at localhost:57127
2025-04-15 14:41:27.955 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:57127 (timeout: 5000 ms)
2025-04-15 14:41:27.955 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:57127
2025-04-15 14:41:27.956 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:57432
2025-04-15 14:41:27.958 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"request","traceId":"39cae89e-f98a-4123-a10f-27e6d32f5276","functionName":"toggle","arguments":[]}
2025-04-15 14:41:27.958 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:57432
2025-04-15 14:41:27.959 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"request","traceId":"39cae89e-f98a-4123-a10f-27e6d32f5276","functionName":"toggle","arguments":[]}
2025-04-15 14:41:27.969 [pool-1-thread-2] INFO  c.r.l.middleware.rpc.RpcServer - Received RPC request for function 'toggle' with 0 arguments
2025-04-15 14:41:27.969 [pool-1-thread-2] INFO  c.r.l.application.server.LampImpl - Lamp 'Main Lamp' toggled to: ON
2025-04-15 14:41:27.969 [pool-1-thread-2] INFO  c.r.l.middleware.rpc.RpcServer - Function 'toggle' invoked successfully
2025-04-15 14:41:27.970 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"response","traceId":"39cae89e-f98a-4123-a10f-27e6d32f5276","status":"success","result":"Lamp 'Main Lamp' is now ON","errorMessage":null}
2025-04-15 14:41:27.970 [pool-1-thread-2] INFO  c.r.l.middleware.rpc.RpcServer - Sent RPC response for function 'toggle'
2025-04-15 14:41:27.971 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:57432
2025-04-15 14:41:27.971 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"response","traceId":"39cae89e-f98a-4123-a10f-27e6d32f5276","status":"success","result":"Lamp 'Main Lamp' is now ON","errorMessage":null}
2025-04-15 14:41:27.975 [main] INFO  c.r.l.middleware.rpc.RpcClient - Function 'toggle' invoked successfully
2025-04-15 14:41:27.975 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:57127
2025-04-15 14:41:33.676 [main] INFO  c.r.l.m.registry.RegistryClient - Looking up service 'toggle' in registry at localhost:9999
2025-04-15 14:41:33.676 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:9999 (timeout: 5000 ms)
2025-04-15 14:41:33.677 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:9999
2025-04-15 14:41:33.677 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:57500
2025-04-15 14:41:33.677 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"lookup","traceId":"19485784-71b1-4c20-ad50-a0b9fb201282","functionName":"toggle"}
2025-04-15 14:41:33.678 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:57500
2025-04-15 14:41:33.678 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Received raw message: {"version":"1.0","type":"lookup","traceId":"19485784-71b1-4c20-ad50-a0b9fb201282","functionName":"toggle"}
2025-04-15 14:41:33.679 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Received lookup request for function 'toggle'
2025-04-15 14:41:33.679 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Function 'toggle' found at localhost:57127
2025-04-15 14:41:33.679 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"lookupResponse","traceId":"19485784-71b1-4c20-ad50-a0b9fb201282","status":"success","host":"localhost","port":57127,"errorMessage":null}
2025-04-15 14:41:33.680 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:57500
2025-04-15 14:41:33.680 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"lookupResponse","traceId":"19485784-71b1-4c20-ad50-a0b9fb201282","status":"success","host":"localhost","port":57127,"errorMessage":null}
2025-04-15 14:41:33.680 [main] INFO  c.r.l.m.registry.RegistryClient - Service 'toggle' found at localhost:57127
2025-04-15 14:41:33.681 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:9999
2025-04-15 14:41:33.681 [main] INFO  c.r.l.middleware.rpc.RpcClient - Invoking function 'toggle' at localhost:57127
2025-04-15 14:41:33.681 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:57127 (timeout: 5000 ms)
2025-04-15 14:41:33.682 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:57127
2025-04-15 14:41:33.682 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"request","traceId":"4937452a-daf4-4027-ad54-661e932fce0e","functionName":"toggle","arguments":[]}
2025-04-15 14:41:33.682 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:57501
2025-04-15 14:41:33.683 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:57501
2025-04-15 14:41:33.683 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"request","traceId":"4937452a-daf4-4027-ad54-661e932fce0e","functionName":"toggle","arguments":[]}
2025-04-15 14:41:33.684 [pool-1-thread-2] INFO  c.r.l.middleware.rpc.RpcServer - Received RPC request for function 'toggle' with 0 arguments
2025-04-15 14:41:33.684 [pool-1-thread-2] INFO  c.r.l.application.server.LampImpl - Lamp 'Main Lamp' toggled to: OFF
2025-04-15 14:41:33.684 [pool-1-thread-2] INFO  c.r.l.middleware.rpc.RpcServer - Function 'toggle' invoked successfully
2025-04-15 14:41:33.684 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"response","traceId":"4937452a-daf4-4027-ad54-661e932fce0e","status":"success","result":"Lamp 'Main Lamp' is now OFF","errorMessage":null}
2025-04-15 14:41:33.685 [pool-1-thread-2] INFO  c.r.l.middleware.rpc.RpcServer - Sent RPC response for function 'toggle'
2025-04-15 14:41:33.685 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:57501
2025-04-15 14:41:33.685 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"response","traceId":"4937452a-daf4-4027-ad54-661e932fce0e","status":"success","result":"Lamp 'Main Lamp' is now OFF","errorMessage":null}
2025-04-15 14:41:33.685 [main] INFO  c.r.l.middleware.rpc.RpcClient - Function 'toggle' invoked successfully
2025-04-15 14:41:33.686 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:57127
2025-04-15 14:41:36.707 [main] INFO  c.r.l.m.registry.RegistryClient - Looking up service 'isOn' in registry at localhost:9999
2025-04-15 14:41:36.708 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:9999 (timeout: 5000 ms)
2025-04-15 14:41:36.709 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:9999
2025-04-15 14:41:36.709 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:57525
2025-04-15 14:41:36.709 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"lookup","traceId":"0fdbffc2-e357-4589-9652-fcb2eeddfbe1","functionName":"isOn"}
2025-04-15 14:41:36.710 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:57525
2025-04-15 14:41:36.710 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Received raw message: {"version":"1.0","type":"lookup","traceId":"0fdbffc2-e357-4589-9652-fcb2eeddfbe1","functionName":"isOn"}
2025-04-15 14:41:36.710 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Received lookup request for function 'isOn'
2025-04-15 14:41:36.711 [pool-1-thread-2] INFO  c.r.l.m.registry.RegistryServer - Function 'isOn' found at localhost:57127
2025-04-15 14:41:36.711 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"lookupResponse","traceId":"0fdbffc2-e357-4589-9652-fcb2eeddfbe1","status":"success","host":"localhost","port":57127,"errorMessage":null}
2025-04-15 14:41:36.711 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:57525
2025-04-15 14:41:36.711 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"lookupResponse","traceId":"0fdbffc2-e357-4589-9652-fcb2eeddfbe1","status":"success","host":"localhost","port":57127,"errorMessage":null}
2025-04-15 14:41:36.712 [main] INFO  c.r.l.m.registry.RegistryClient - Service 'isOn' found at localhost:57127
2025-04-15 14:41:36.712 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:9999
2025-04-15 14:41:36.712 [main] INFO  c.r.l.middleware.rpc.RpcClient - Invoking function 'isOn' at localhost:57127
2025-04-15 14:41:36.712 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:57127 (timeout: 5000 ms)
2025-04-15 14:41:36.713 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:57526
2025-04-15 14:41:36.713 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:57127
2025-04-15 14:41:36.714 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"request","traceId":"ace0d984-5833-4fa2-835c-d94d006a0e7c","functionName":"isOn","arguments":[]}
2025-04-15 14:41:36.714 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:57526
2025-04-15 14:41:36.714 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"request","traceId":"ace0d984-5833-4fa2-835c-d94d006a0e7c","functionName":"isOn","arguments":[]}
2025-04-15 14:41:36.715 [pool-1-thread-2] INFO  c.r.l.middleware.rpc.RpcServer - Received RPC request for function 'isOn' with 0 arguments
2025-04-15 14:41:36.715 [pool-1-thread-2] INFO  c.r.l.middleware.rpc.RpcServer - Function 'isOn' invoked successfully
2025-04-15 14:41:36.717 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"response","traceId":"ace0d984-5833-4fa2-835c-d94d006a0e7c","status":"success","result":false,"errorMessage":null}
2025-04-15 14:41:36.717 [pool-1-thread-2] INFO  c.r.l.middleware.rpc.RpcServer - Sent RPC response for function 'isOn'
2025-04-15 14:41:36.717 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:57526
2025-04-15 14:41:36.717 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"response","traceId":"ace0d984-5833-4fa2-835c-d94d006a0e7c","status":"success","result":false,"errorMessage":null}
2025-04-15 14:41:36.718 [main] INFO  c.r.l.middleware.rpc.RpcClient - Function 'isOn' invoked successfully
2025-04-15 14:41:36.718 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:57127
2025-04-15 14:45:00.074 [main] INFO  c.r.l.m.registry.RegistryServer - Starting registry server on port 9999
2025-04-15 14:45:00.080 [main] ERROR c.r.l.m.registry.RegistryLauncher - Failed to start registry server: Address already in use
2025-04-15 14:45:00.081 [Thread-0] INFO  c.r.l.m.registry.RegistryLauncher - Shutting down registry server...
2025-04-15 14:45:00.081 [Thread-0] INFO  c.r.l.m.registry.RegistryServer - Stopping registry server
2025-04-15 14:45:00.081 [Thread-0] INFO  c.r.l.m.registry.RegistryServer - Registry server stopped
2025-04-15 14:45:10.992 [main] INFO  c.r.l.application.server.ServerMain - Using registry port: 9999
2025-04-15 14:45:10.993 [main] INFO  c.r.l.m.registry.RegistryClient - RegistryClient configured to use registry at localhost:9999
2025-04-15 14:45:10.994 [main] INFO  c.r.l.middleware.rpc.RpcServer - Starting RPC server on port 0
2025-04-15 14:45:11.000 [main] INFO  c.r.l.m.transport.ServerTransport - Server started on port 59532
2025-04-15 14:45:11.001 [main] INFO  c.r.l.middleware.rpc.RpcServer - RPC server started on port 59532
2025-04-15 14:45:11.001 [main] INFO  c.r.l.application.server.LampImpl - Lamp 'Main Lamp' created, initial state: OFF
2025-04-15 14:45:11.309 [main] INFO  c.r.l.middleware.rpc.RpcServer - Registered function 'toggle' locally
2025-04-15 14:45:11.309 [main] INFO  c.r.l.m.registry.RegistryClient - Registering service 'toggle' at localhost:59532 with registry at localhost:9999
2025-04-15 14:45:11.329 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:9999 (timeout: 5000 ms)
2025-04-15 14:45:11.334 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:9999
2025-04-15 14:45:11.336 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:59534
2025-04-15 14:45:11.338 [pool-1-thread-3] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:59534
2025-04-15 14:45:11.413 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"register","traceId":"8cdd50a7-46e6-493d-a87a-6fdc0f88ffd3","functionName":"toggle","host":"localhost","port":59532}
2025-04-15 14:45:11.414 [pool-1-thread-3] DEBUG c.r.l.m.transport.ConnectionHandler - Received raw message: {"version":"1.0","type":"register","traceId":"8cdd50a7-46e6-493d-a87a-6fdc0f88ffd3","functionName":"toggle","host":"localhost","port":59532}
2025-04-15 14:45:11.416 [pool-1-thread-3] INFO  c.r.l.m.registry.RegistryServer - Received register request for function 'toggle' at localhost:59532
2025-04-15 14:45:11.416 [pool-1-thread-3] INFO  c.r.l.m.registry.RegistryServer - Function 'toggle' already registered, updating to localhost:59532
2025-04-15 14:45:11.416 [pool-1-thread-3] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"registerResponse","traceId":"8cdd50a7-46e6-493d-a87a-6fdc0f88ffd3","status":"success","message":"Function 'toggle' registration updated"}
2025-04-15 14:45:11.417 [pool-1-thread-3] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:59534
2025-04-15 14:45:11.417 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"registerResponse","traceId":"8cdd50a7-46e6-493d-a87a-6fdc0f88ffd3","status":"success","message":"Function 'toggle' registration updated"}
2025-04-15 14:45:11.430 [main] INFO  c.r.l.m.registry.RegistryClient - Service 'toggle' registered successfully: Function 'toggle' registration updated
2025-04-15 14:45:11.433 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:9999
2025-04-15 14:45:11.433 [main] INFO  c.r.l.middleware.rpc.RpcServer - Registered function 'toggle' with registry at localhost:59532
2025-04-15 14:45:11.433 [main] INFO  c.r.l.middleware.rpc.RpcServer - Registered function 'isOn' locally
2025-04-15 14:45:11.433 [main] INFO  c.r.l.m.registry.RegistryClient - Registering service 'isOn' at localhost:59532 with registry at localhost:9999
2025-04-15 14:45:11.433 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:9999 (timeout: 5000 ms)
2025-04-15 14:45:11.433 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:9999
2025-04-15 14:45:11.433 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:59535
2025-04-15 14:45:11.434 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"register","traceId":"eb42143c-4339-4412-9822-2664a3448547","functionName":"isOn","host":"localhost","port":59532}
2025-04-15 14:45:11.434 [pool-1-thread-3] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:59535
2025-04-15 14:45:11.434 [pool-1-thread-3] DEBUG c.r.l.m.transport.ConnectionHandler - Received raw message: {"version":"1.0","type":"register","traceId":"eb42143c-4339-4412-9822-2664a3448547","functionName":"isOn","host":"localhost","port":59532}
2025-04-15 14:45:11.434 [pool-1-thread-3] INFO  c.r.l.m.registry.RegistryServer - Received register request for function 'isOn' at localhost:59532
2025-04-15 14:45:11.434 [pool-1-thread-3] INFO  c.r.l.m.registry.RegistryServer - Function 'isOn' already registered, updating to localhost:59532
2025-04-15 14:45:11.434 [pool-1-thread-3] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"registerResponse","traceId":"eb42143c-4339-4412-9822-2664a3448547","status":"success","message":"Function 'isOn' registration updated"}
2025-04-15 14:45:11.435 [pool-1-thread-3] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:59535
2025-04-15 14:45:11.435 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"registerResponse","traceId":"eb42143c-4339-4412-9822-2664a3448547","status":"success","message":"Function 'isOn' registration updated"}
2025-04-15 14:45:11.435 [main] INFO  c.r.l.m.registry.RegistryClient - Service 'isOn' registered successfully: Function 'isOn' registration updated
2025-04-15 14:45:11.435 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:9999
2025-04-15 14:45:11.435 [main] INFO  c.r.l.middleware.rpc.RpcServer - Registered function 'isOn' with registry at localhost:59532
2025-04-15 14:45:11.435 [main] INFO  c.r.l.application.server.ServerMain - Lamp server started on port 59532. Press Ctrl+C to exit.
2025-04-15 14:45:11.959 [AWT-EventQueue-0] INFO  c.r.l.application.server.LampImpl - Lamp GUI initialized for 'Main Lamp'
2025-04-15 14:45:20.446 [main] INFO  c.r.l.application.client.ClientMain - Using registry port: 9999
2025-04-15 14:45:20.448 [main] INFO  c.r.l.m.registry.RegistryClient - RegistryClient configured to use registry at localhost:9999
2025-04-15 14:45:26.826 [main] INFO  c.r.l.m.registry.RegistryClient - Looking up service 'toggle' in registry at localhost:9999
2025-04-15 14:45:26.851 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:9999 (timeout: 5000 ms)
2025-04-15 14:45:26.864 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:9999
2025-04-15 14:45:26.863 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:59675
2025-04-15 14:45:26.865 [pool-1-thread-3] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:59675
2025-04-15 14:45:26.935 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"lookup","traceId":"2bd3cb5d-d146-43ee-ba30-99d02dc972be","functionName":"toggle"}
2025-04-15 14:45:26.935 [pool-1-thread-3] DEBUG c.r.l.m.transport.ConnectionHandler - Received raw message: {"version":"1.0","type":"lookup","traceId":"2bd3cb5d-d146-43ee-ba30-99d02dc972be","functionName":"toggle"}
2025-04-15 14:45:26.936 [pool-1-thread-3] INFO  c.r.l.m.registry.RegistryServer - Received lookup request for function 'toggle'
2025-04-15 14:45:26.937 [pool-1-thread-3] INFO  c.r.l.m.registry.RegistryServer - Function 'toggle' found at localhost:59532
2025-04-15 14:45:26.937 [pool-1-thread-3] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"lookupResponse","traceId":"2bd3cb5d-d146-43ee-ba30-99d02dc972be","status":"success","host":"localhost","port":59532,"errorMessage":null}
2025-04-15 14:45:26.937 [pool-1-thread-3] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:59675
2025-04-15 14:45:26.937 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"lookupResponse","traceId":"2bd3cb5d-d146-43ee-ba30-99d02dc972be","status":"success","host":"localhost","port":59532,"errorMessage":null}
2025-04-15 14:45:26.953 [main] INFO  c.r.l.m.registry.RegistryClient - Service 'toggle' found at localhost:59532
2025-04-15 14:45:26.954 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:9999
2025-04-15 14:45:26.954 [main] INFO  c.r.l.middleware.rpc.RpcClient - Invoking function 'toggle' at localhost:59532
2025-04-15 14:45:26.954 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:59532 (timeout: 5000 ms)
2025-04-15 14:45:26.954 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:59532
2025-04-15 14:45:26.955 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:59676
2025-04-15 14:45:26.957 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"request","traceId":"7f032fbd-3b25-4bb7-9403-2536cc40dee9","functionName":"toggle","arguments":[]}
2025-04-15 14:45:26.957 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:59676
2025-04-15 14:45:26.958 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"request","traceId":"7f032fbd-3b25-4bb7-9403-2536cc40dee9","functionName":"toggle","arguments":[]}
2025-04-15 14:45:26.976 [pool-1-thread-2] INFO  c.r.l.middleware.rpc.RpcServer - Received RPC request for function 'toggle' with 0 arguments
2025-04-15 14:45:26.976 [pool-1-thread-2] INFO  c.r.l.application.server.LampImpl - Lamp 'Main Lamp' toggled to: ON
2025-04-15 14:45:26.976 [pool-1-thread-2] INFO  c.r.l.middleware.rpc.RpcServer - Function 'toggle' invoked successfully
2025-04-15 14:45:26.977 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"response","traceId":"7f032fbd-3b25-4bb7-9403-2536cc40dee9","status":"success","result":"Lamp 'Main Lamp' is now ON","errorMessage":null}
2025-04-15 14:45:26.977 [pool-1-thread-2] INFO  c.r.l.middleware.rpc.RpcServer - Sent RPC response for function 'toggle'
2025-04-15 14:45:26.977 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:59676
2025-04-15 14:45:26.977 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"response","traceId":"7f032fbd-3b25-4bb7-9403-2536cc40dee9","status":"success","result":"Lamp 'Main Lamp' is now ON","errorMessage":null}
2025-04-15 14:45:26.981 [main] INFO  c.r.l.middleware.rpc.RpcClient - Function 'toggle' invoked successfully
2025-04-15 14:45:26.982 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:59532
2025-04-15 14:45:33.770 [main] INFO  c.r.l.m.registry.RegistryClient - Looking up service 'toggle' in registry at localhost:9999
2025-04-15 14:45:33.771 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:9999 (timeout: 5000 ms)
2025-04-15 14:45:33.772 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:9999
2025-04-15 14:45:33.772 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:59747
2025-04-15 14:45:33.772 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"lookup","traceId":"42aba4c5-8f04-437a-83c0-be4e174410f8","functionName":"toggle"}
2025-04-15 14:45:33.773 [pool-1-thread-3] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:59747
2025-04-15 14:45:33.773 [pool-1-thread-3] DEBUG c.r.l.m.transport.ConnectionHandler - Received raw message: {"version":"1.0","type":"lookup","traceId":"42aba4c5-8f04-437a-83c0-be4e174410f8","functionName":"toggle"}
2025-04-15 14:45:33.773 [pool-1-thread-3] INFO  c.r.l.m.registry.RegistryServer - Received lookup request for function 'toggle'
2025-04-15 14:45:33.774 [pool-1-thread-3] INFO  c.r.l.m.registry.RegistryServer - Function 'toggle' found at localhost:59532
2025-04-15 14:45:33.774 [pool-1-thread-3] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"lookupResponse","traceId":"42aba4c5-8f04-437a-83c0-be4e174410f8","status":"success","host":"localhost","port":59532,"errorMessage":null}
2025-04-15 14:45:33.774 [pool-1-thread-3] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:59747
2025-04-15 14:45:33.774 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"lookupResponse","traceId":"42aba4c5-8f04-437a-83c0-be4e174410f8","status":"success","host":"localhost","port":59532,"errorMessage":null}
2025-04-15 14:45:33.775 [main] INFO  c.r.l.m.registry.RegistryClient - Service 'toggle' found at localhost:59532
2025-04-15 14:45:33.776 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:9999
2025-04-15 14:45:33.776 [main] INFO  c.r.l.middleware.rpc.RpcClient - Invoking function 'toggle' at localhost:59532
2025-04-15 14:45:33.776 [main] INFO  c.r.l.m.transport.ClientTransport - Connecting to localhost:59532 (timeout: 5000 ms)
2025-04-15 14:45:33.777 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:59532
2025-04-15 14:45:33.777 [pool-1-thread-1] INFO  c.r.l.m.transport.ServerTransport - Accepted connection from 127.0.0.1:59748
2025-04-15 14:45:33.777 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"request","traceId":"03eaf5f3-12a4-4dfa-aad8-0b3da718266c","functionName":"toggle","arguments":[]}
2025-04-15 14:45:33.777 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection established with 127.0.0.1:59748
2025-04-15 14:45:33.778 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"request","traceId":"03eaf5f3-12a4-4dfa-aad8-0b3da718266c","functionName":"toggle","arguments":[]}
2025-04-15 14:45:33.779 [pool-1-thread-2] INFO  c.r.l.middleware.rpc.RpcServer - Received RPC request for function 'toggle' with 0 arguments
2025-04-15 14:45:33.779 [pool-1-thread-2] INFO  c.r.l.application.server.LampImpl - Lamp 'Main Lamp' toggled to: OFF
2025-04-15 14:45:33.779 [pool-1-thread-2] INFO  c.r.l.middleware.rpc.RpcServer - Function 'toggle' invoked successfully
2025-04-15 14:45:33.779 [pool-1-thread-2] DEBUG c.r.l.m.transport.ConnectionHandler - Sending message: {"version":"1.0","type":"response","traceId":"03eaf5f3-12a4-4dfa-aad8-0b3da718266c","status":"success","result":"Lamp 'Main Lamp' is now OFF","errorMessage":null}
2025-04-15 14:45:33.779 [pool-1-thread-2] INFO  c.r.l.middleware.rpc.RpcServer - Sent RPC response for function 'toggle'
2025-04-15 14:45:33.780 [main] DEBUG c.r.l.m.transport.ConnectionHandler - Received message: {"version":"1.0","type":"response","traceId":"03eaf5f3-12a4-4dfa-aad8-0b3da718266c","status":"success","result":"Lamp 'Main Lamp' is now OFF","errorMessage":null}
2025-04-15 14:45:33.780 [pool-1-thread-2] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:59748
2025-04-15 14:45:33.780 [main] INFO  c.r.l.middleware.rpc.RpcClient - Function 'toggle' invoked successfully
2025-04-15 14:45:33.780 [main] INFO  c.r.l.m.transport.ConnectionHandler - Connection closed with 127.0.0.1:59532
